import java.util.ArrayList;
import java.util.Scanner;

/**
 * Sistema de Agenda - Gerenciamento de Reservas usando ArrayList.
 * Autor: Gabriel Sera
 */
public class AgendaApp {
    private static ArrayList<Reserva> reservas = new ArrayList<>();
    private static Scanner scanner = new Scanner(System.in);

    public static void main(String[] args) {
        int opcao;
        do {
            System.out.println("\n--- MENU AGENDA ---");
            System.out.println("1. Incluir nova reserva");
            System.out.println("2. Alterar reserva");
            System.out.println("3. Excluir reserva");
            System.out.println("4. Consultar reserva");
            System.out.println("5. Listar todas as reservas");
            System.out.println("0. Sair");
            System.out.print("Escolha uma opção: ");
            opcao = scanner.nextInt();
            scanner.nextLine(); // Limpa o buffer

            switch(opcao) {
                case 1: incluirReserva(); break;
                case 2: alterarReserva(); break;
                case 3: excluirReserva(); break;
                case 4: consultarReserva(); break;
                case 5: listarReservas(); break;
                case 0: System.out.println("Saindo..."); break;
                default: System.out.println("Opção inválida!");
            }
        } while (opcao != 0);
    }

    // 1. Incluir nova reserva
    private static void incluirReserva() {
        System.out.print("Nome: ");
        String nome = scanner.nextLine();
        System.out.print("Data (dd/mm/aaaa): ");
        String data = scanner.nextLine();
        System.out.print("Hora (HH:mm): ");
        String hora = scanner.nextLine();
        Reserva nova = new Reserva(nome, data, hora);
        reservas.add(nova);
        System.out.println("Reserva adicionada com sucesso!");
    }

    // 2. Alterar reserva
    private static void alterarReserva() {
        System.out.print("Digite o nome da pessoa para alterar a reserva: ");
        String nome = scanner.nextLine();
        int index = buscarReservaPorNome(nome);
        if (index != -1) {
            Reserva res = reservas.get(index);
            System.out.print("Nova data (atual: " + res.getData() + "): ");
            String novaData = scanner.nextLine();
            System.out.print("Nova hora (atual: " + res.getHora() + "): ");
            String novaHora = scanner.nextLine();
            res.setData(novaData);
            res.setHora(novaHora);
            System.out.println("Reserva alterada com sucesso!");
        } else {
            System.out.println("Reserva não encontrada!");
        }
    }

    // 3. Excluir reserva
    private static void excluirReserva() {
        System.out.print("Digite o nome da pessoa para excluir a reserva: ");
        String nome = scanner.nextLine();
        int index = buscarReservaPorNome(nome);
        if (index != -1) {
            reservas.remove(index);
            System.out.println("Reserva excluída com sucesso!");
        } else {
            System.out.println("Reserva não encontrada!");
        }
    }

    // 4. Consultar reserva
    private static void consultarReserva() {
        System.out.println("Consultar por: 1-Nome  2-Data  3-Hora");
        int tipo = scanner.nextInt();
        scanner.nextLine();
        boolean achou = false;
        switch (tipo) {
            case 1:
                System.out.print("Nome: ");
                String nome = scanner.nextLine();
                for (Reserva r : reservas)
                    if (r.getNome().equalsIgnoreCase(nome)) {
                        System.out.println(r);
                        achou = true;
                    }
                break;
            case 2:
                System.out.print("Data (dd/mm/aaaa): ");
                String data = scanner.nextLine();
                for (Reserva r : reservas)
                    if (r.getData().equals(data)) {
                        System.out.println(r);
                        achou = true;
                    }
                break;
            case 3:
                System.out.print("Hora (HH:mm): ");
                String hora = scanner.nextLine();
                for (Reserva r : reservas)
                    if (r.getHora().equals(hora)) {
                        System.out.println(r);
                        achou = true;
                    }
                break;
            default:
                System.out.println("Tipo inválido!");
                return;
        }
        if (!achou)
            System.out.println("Reserva não encontrada!");
    }

    // 5. Listar todas as reservas
    private static void listarReservas() {
        if (reservas.isEmpty()) {
            System.out.println("Nenhuma reserva cadastrada.");
        } else {
            System.out.println("Reservas registradas:");
            for (Reserva r : reservas) {
                System.out.println(r);
            }
        }
    }

    // Busca reserva pelo nome (primeira ocorrência)
    private static int buscarReservaPorNome(String nome) {
        for (int i = 0; i < reservas.size(); i++) {
            if (reservas.get(i).getNome().equalsIgnoreCase(nome)) {
                return i;
            }
        }
        return -1;
    }
}